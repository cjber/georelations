---
author: 'Cillian Berragan'
date: "`r format(Sys.time(), '%d %B, %Y')`"
university: 'University of Liverpool'
title: 'Extracting Geographic knowledge from unstructured text'
abstract: ''
keywords: ''
output: 
        pdf_document:
                number_sections: true
bibliography:
    - /home/cjber/drive/bib/zbib.bib
csl: /home/cjber/drive/bib/uol_cb.csl
link-citations: yes
---

# Methods Overview

## Data collection
  * [x] Wikipedia
  * [x] Other (travelblog, geograph)

## Data pre-processing

* [x] **Coreference resolution** (Document level)

> _Headingley is a suburb in Leeds. It is the location of Beckett Park._ $\rightarrow$\
  _Headingley is a suburb in Leeds. Headingley is the location of Beckett Park._

## Relation Classification Dataset

1. **RoBERTa transformer fine-tuned for token classification**
    * Resolved coreferences
    * Re-label Wikipedia subset using Doccano (as coreferences are resolved)?

> _{Headingley} is a {suburb} in {Leeds}._

2. **SemEval 2010 Task 8 style Dataset**

    * Entities automatically identified in (1)
    * Relation type manually labelled in doccano


> \texttt{Headingley is a suburb of Leeds, West Yorkshire, England, approximately two miles out of the city centre, to the north west along the A660 road.}

> \texttt{Sentence: [E1]Headingley[/E1] is a suburb in [E2]Leeds[/E2]...}
>
> \texttt{Label: NTPP(e1,e2)}
>
> \texttt{Sentence: [E1]Headingley[/E1] is a [E2]suburb[/E2] in Leeds...}
>
> \texttt{Label: EQ(e1,e2)}
>
> \texttt{Sentence: [E1]Headingley[/E1] ... two miles out of the [E2]city centre[/E2]}
>
> \texttt{Label: DC(e1,e2) (mod: two miles)}
>
> \texttt{Sentence: [E1]Headingley[/E1]... along the [E2]A660[/E2] road.}
>
> \texttt{Label: EC(e1,e2)}

> NOTE: `eq()` relationships can only exist between a named entity and a nominal. All other relationships must exist between two named entities.

3. **BERT-based relation classification model**
   * [R-BERT](https://github.com/monologg/R-BERT) or [Matching the Blanks](https://github.com/plkmo/BERT-Relation-Extraction)


## Knowledge graph creation

* [ ] **Known Toponym Resolution**
  * Ordnance Survey open names
  * Mordecai or custom system
  * Wikipedia article coordinates

* [ ] **Knowledge graph**
  * Neo4j
  * TR $\Leftrightarrow$ Entity linking
  * @stock2014: geometric configuration ontology
  * Derive bounding boxes from relations using collection of relations and known place locations

```{r, echo=FALSE}
knitr::include_graphics("figs/rcc.pdf")
```

# Literature

## Coreference

Just problem definition + why needed?

## Geographic Relations

### Extraction

[@kordjamshidi2010;@ludwig2016;@wallgrun2014;@qiu2019]

* Relation Extraction
* Spatial Role Labelling
* Landmark, Trajector, Spatial Indicator
* Various Methods (see @herman2019):
    1. Rule-based
    2. Weakly supervised
    3. Distantly supervised
    4. Unsupervised
* Existing work:
    1. GATE @bontcheva2003
    2. CoreNLP (Stanford)
    3. BERT-based @soares2019, see @soh2020

### Resolution

[@aflaki2018;@purves2018;@al-olimat2019;@du2017]

* Region Connection Calculus (RCC8) 
* Classifying relations

## Knowledge Graphs

* Geographic knowledge graph as a gazetteer

# Misc.

## Use of fine-tuned GER model

1. Sequence of tokens $\mathbf{w} = \{w_{1}, \dots, w_{k}\}$ where $k$ is the length of the sequence. Each sequence is present as a sentence in a document $\mathbf{w} \in \mathbf{d}$, and where $\mathbf{d} \in \mathbf{C}$, the collection of all documents. In this case a document is a Wikipedia article summary.
2. Token sequences encoded to integers using a vocabulary of around 50,000 tokens.
3. Passed through transformer layers at various hidden dimensions. Transformer attention capturing context etc.
4. Final RoBERTa layer passed into a linear layer with an output dimension of the number of unique tags $t$ (BILUO tags for PLACE_NAM PLACE_NOM).
5. Outputs: Matrix of logits $\mathbf{L}_{t \times k}$. To find the predicted tags $\mathbf{t} = \{t_1, \dots, t_k\}$ for a sequence $\mathbf{w}$, the argmax is taken across the $k$ dimension of $\mathbf{L}$ to find the position of the largest $logit$ value for each $w_i \in \mathbf{w}$. The values in $\mathbf{t}$ are then mapped to a string representation of the tags.


\[
 \mathbf{L}_{k,t} = 
 \begin{pmatrix}
  l_{1,1} & l_{1,2} & \cdots & l_{1,t} \\
  l_{2,1} & l_{2,2} & \cdots & l_{2,t} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  l_{k,1} & l_{k,2} & \cdots & l_{k,t} 
 \end{pmatrix} \overset{argmax}{\longrightarrow}
\begin{pmatrix}
  1 & 0 & \cdots & 0 \\
  0 & 1 & \cdots & 0\\
  \vdots  & \vdots  & \ddots & \vdots  \\
  1 & 0 & \cdots & 0
 \end{pmatrix} \longrightarrow
 \begin{pmatrix}
 place \\
 other \\
 \dots \\
 place
 \end{pmatrix}
\]

if $l_{1,1}, l_{2,2}, l_{t,1}$ are the highest $logit$ values across the $k$ dimension.

## NOTES

[@ludwig2016]: an issue in extracting spatial semantics from natural language is the lack of annotated data on which machine learning can be employed to learn and extract the spatial relations



Particulars (city county etc.) vs universals
instance to universal Liverpool is a city etc.

Note difference between universals and city centre in above sentence

1. Scrap nominals? Instance to instance relationships

NOTES: [@smith]:
Particulars + Universals. Continuants and Occurents.

Formal ontological relation - _part of_. 

Three typical top-level relation types:
<_universal_, _universal_>: Both relata are universsals. An example of this type of relation is characterization, or the subsumption (_is\_a_) relation which obtains between the universtal human and the universal mammal. Such that human is\_a mammal.

<**instance**, _universal_>: The first relatum is a particular, the second is a universal. An example of a relation of this type is the instantiation relation, which obtains between this particular person named Peter and thje universal _human_, or between Peter's life and the universal _life_. Another example is the relation of _being allergic to_ that exists between Peter and the universal _aspirin_.

<**instance**, **instance**>: Both relata are particulars. Examples include the inherence relation, or the participation relation which obtains between Peter's life and Peter, or also - independently of the ontological sextet - the part-whole relation on the level of instances, which obtains between this particular nose (Peter's nose) and this particular head (Peter's head), and between both of these and peter.

_italics_ for relations between universals and **bold** for relations with at least one particular. Use expressions common in ontology: _is\_a_ for a subsumption relation and **instance\_of** for the instantiation relation. Confined to binary relations.

Knowledge typically concerns itself with universals (e.g. _part\_of_ relationships) e.g. in Biology.

## In terms of Geography

**Particulars**, _Universal_

Characterization relation <_universal_, _universal_>: <_suburb_, (_type\_of_), _residential area_>

Instantiation relation <**instance**, _universal_>: <**Liverpool**, (**instance\_of**), _city_>.

Participation relation <**instance**, **instance**>: <**Liverpool**, (**located\_in**), **Merseyside**>

$r \ \mathbf{instance\_of} \ R$

$r_{1} \ \mathbf{located\_in} \ r_{2}$

A _suburb_ is a _mixed-use_ or _residential area_, existing either as part of a _city_ or _urban area_ or as a separate _residential community_ within commuting distance of a _city_.

<_suburb_, (_type\_of_), _mixed-use_>, <_suburb_, (_type\_of_), _residential area_>

<_suburb_, (_part\_of_), _city_>, <_suburb_, (_part\_of_), _urban area_>

<_suburb_, (_near\_to_), _city_>

<_suburb_, (_equivalent\_to_), _residential community_>

NOTE: part of here is not representing a spatial/geographic relationship. Part of is compositional, a geographic relation would be represented through _located\_in_. Suburbs while described as existing as part of a city are not necessarily located within the regional bounds of a city.

